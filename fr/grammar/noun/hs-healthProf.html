<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Medical Terms - Hotspots</title>

    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-CHXHM9CZKM"
    ></script>

    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-CHXHM9CZKM");
    </script>
    <!-- offline enabler -->
    <link rel="manifest" href="manifest.json" />
    <link rel="apple-touch-icon" href="icon-192.png" />

    <!-- Favicons -->
    <link href="/img/favicon.png" rel="icon" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../../../assets/css/hotspot.css" />
    <style>
      .flashcard-container img {
        width: 100%; /* Allows the image to shrink/grow with the screen */
        max-width: 800px; /* Prevents the image from getting larger than 800px */
        height: auto; /* Maintains the aspect ratio so it doesn't skew */
      }
    </style>
  </head>
  <body>
    <div class="container-fluid px-0 py-5">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="thumbnail-section full-bleed">
            <h6 class="fw-bold mb-2">Jump to card</h6>
            <div class="thumbnail-strip" id="thumbnailStrip"></div>
          </div>

          <div class="flashcard-container" id="flashcard">
            <div class="flashcard-inner">
              <div
                class="flashcard-front d-flex align-items-center justify-content-center bg-white rounded"
              >
                <h3 id="card-front-text">Loading...</h3>
              </div>
            </div>
          </div>

          <!-- Randomization -->
          <div class="d-flex justify-content-center gap-2 mb-3">
            <button class="btn btn-warning" onclick="shuffleDeck()">
              <i class="bi bi-shuffle"></i> Shuffle Cards
            </button>
            <button class="btn btn-outline-warning" onclick="reorderDeck()">
              Reorder Cards
            </button>
          </div>

          <div class="d-flex justify-content-between mt-4">
            <button class="btn btn-outline-secondary" onclick="prevCard()">
              Previous
            </button>
            <span id="card-count" class="align-self-center text-muted"
              >1 / 5</span
            >
            <button class="btn btn-outline-primary" onclick="nextCard()">
              Next
            </button>
          </div>
        </div>
      </div>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"
      defer
    ></script>

    <script>
      // 1. Your Data (This acts as your "Database")
      const baseDeck = [
        {
          img: "../../../assets/img/body/healthProf.jpg",
          alt: "head",
          hotspots: [
            {
              left: "6%",
              top: "10%",
              en: "doctor",
              fr: "médecin (m)",
              ipa: "/med(ə)sɛ̃/",
            },
            {
              left: "28%",
              top: "10%",
              en: "nurse",
              fr: "infirmier / infirmière (m/f)",
              ipa: "/ɛ̃fiʀmje, εr/",
            },
            {
              left: "45%",
              top: "10%",
              en: "surgeon",
              fr: "chirurgien (m)",
              ipa: "/ʃiʀyʀʒjɛ̃/",
            },
            {
              left: "60%",
              top: "10%",
              en: "anesthesiologist",
              fr: "anesthésiste (m/f)",
              ipa: "/anɛstezist/",
            },
            {
              left: "79%",
              top: "10%",
              en: "paramedic",
              fr: "ambulancier / ambulancière (m/f)",
              ipa: "/ɑ̃bylɑ̃sje, εr/",
            },
            {
              left: "4%",
              top: "56%",
              en: "pharmacist",
              fr: "pharmacien / pharmacienne (m/f)",
              ipa: "/faʀmasjɛ̃, εn/",
            },
            {
              left: "22%",
              top: "56%",
              en: "midwife",
              fr: "sage-femme (f)",
              ipa: "/saʒfam/",
            },
            {
              left: "37%",
              top: "56%",
              en: "pediatrician",
              fr: "pédiatre (m/f)",
              ipa: "/pedjatʀ/",
            },
            {
              left: "52%",
              top: "56%",
              en: "optician",
              fr: "opticien / opticienne (m)",
              ipa: "/ɔptisjɛ̃, εn/",
            },
            {
              left: "69%",
              top: "56%",
              en: "physical therapist",
              fr: "kinésithérapeute (m/f) - Short: kiné",
              ipa: "/kineziteʀapøt/",
            },
            {
              left: "82%",
              top: "56%",
              en: "dentist",
              fr: "dentiste (m/f)",
              ipa: "/dɑ̃tist/",
            },
          ],
        },
        {
          img: "../../../assets/img/body/illness1.jpg",
          alt: "arm and hand",
          hotspots: [
            {
              left: "6%",
              top: "10%",
              en: "cough",
              fr: "tousser (v) / toux (n, f)",
              ipa: "/tuse/  /tu/",
            },
            {
              left: "24%",
              top: "10%",
              en: "cold",
              fr: "rhume (m)",
              ipa: "/ʀym/",
            },
            {
              left: "43%",
              top: "10%",
              en: "allergy",
              fr: "allergie (f)",
              ipa: "/alɛʀʒi/",
            },
            {
              left: "62%",
              top: "10%",
              en: "stuffy nose",
              fr: "nez bouché",
              ipa: "/ne.buʃe/",
            },
            {
              left: "81%",
              top: "10%",
              en: "fever",
              fr: "fièvre (f)",
              ipa: "/fjɛvʀ/",
            },
            {
              left: "7%",
              top: "56%",
              en: "sore throat",
              fr: "mal de gorge",
              ipa: "/mal.də.ɡɔʀʒ/",
            },
            {
              left: "27%",
              top: "56%",
              en: "pink eye",
              fr: "conjonctivite (f)",
              ipa: "/kɔ̃ʒɔ̃ktivit/",
            },
            {
              left: "55%",
              top: "56%",
              en: "canker sore",
              fr: "aphte (m)",
              ipa: "/aft/",
            },
            {
              left: "78%",
              top: "56%",
              en: "toothache",
              fr: "mal de dents",
              ipa: "/mal.də.dɑ̃/",
            },
          ],
        },
        {
          img: "../../../assets/img/body/illness2.jpg",
          alt: "torso",
          hotspots: [
            {
              left: "6%",
              top: "10%",
              en: "runny nose",
              fr: "nez qui coule",
              ipa: "/ne.ki.kul/",
            },
            {
              left: "22%",
              top: "10%",
              en: "virus",
              fr: "virus (m)",
              ipa: "/viʀys/",
            },
            {
              left: "43%",
              top: "10%",
              en: "infection",
              fr: "infection (f)",
              ipa: "/ɛ̃fɛksjɔ̃/",
            },
            {
              left: "62%",
              top: "10%",
              en: "headache",
              fr: "mal de tête",
              ipa: "/mal.də.tɛt/",
            },
            {
              left: "79%",
              top: "10%",
              en: "migraine",
              fr: "migraine (f)",
              ipa: "/miɡʀɛn/",
            },
            {
              left: "4%",
              top: "56%",
              en: "earache",
              fr: "mal d’oreille",
              ipa: "/mal.dɔʀɛj/",
            },
            {
              left: "26%",
              top: "56%",
              en: "nausea",
              fr: "nausée (f)",
              ipa: "/noze/",
            },
            {
              left: "46%",
              top: "56%",
              en: "diarrhea",
              fr: "diarrhée (f)",
              ipa: "/djaʀe/",
            },
            {
              left: "65%",
              top: "56%",
              en: "constipation",
              fr: "constipation (f)",
              ipa: "/kɔ̃stipasjɔ̃/",
            },
            {
              left: "79%",
              top: "56%",
              en: "food poisoning",
              fr: "intoxication alimentaire",
              ipa: "/ɛ̃tɔksikasjɔ̃.alimɑ̃tɛʀ/",
            },
          ],
        },
        {
          img: "../../../assets/img/body/illness3.jpg",
          alt: "leg",
          hotspots: [
            {
              left: "6%",
              top: "10%",
              en: "stomach upset",
              fr: "mal au ventre",
              ipa: "/mal.o.vɑ̃tʀ/",
            },
            {
              left: "22%",
              top: "10%",
              en: "stomach is bloated",
              fr: "estomac est gonflé",
              ipa: "/ɛstɔma.ɛ.ɡɔ̃fle/",
            },
            {
              left: "43%",
              top: "10%",
              en: "acid reflux",
              fr: "reflux gastrique",
              ipa: "/ʀəfly.ɡastʀik/",
            },
            {
              left: "66%",
              top: "10%",
              en: "rash",
              fr: "éruption (f)",
              ipa: "/eʀypsjɔ̃/",
            },
            {
              left: "82%",
              top: "10%",
              en: "scrape",
              fr: "gratter (v)",
              ipa: "/ɡʀate/",
            },
            {
              left: "4%",
              top: "56%",
              en: "bruise",
              fr: "bleu",
              ipa: "/blø/",
            },
            {
              left: "24%",
              top: "56%",
              en: "swollen",
              fr: "enflé / enflée (m/f)",
              ipa: "/ɑ̃fle/",
            },
            {
              left: "46%",
              top: "56%",
              en: "cut",
              fr: "coupure (f)",
              ipa: "/kupyʀ/",
            },
            {
              left: "65%",
              top: "56%",
              en: "burn",
              fr: "brûlure (f)",
              ipa: "/bʀylyʀ/",
            },
            {
              left: "81%",
              top: "56%",
              en: "bitten",
              fr: "mordu",
              ipa: "/mɔrdy/",
            },
          ],
        },
        {
          img: "../../../assets/img/body/illness4.jpg",
          alt: "Gutters and downspouts",
          hotspots: [
            {
              left: "6%",
              top: "10%",
              en: "cramp",
              fr: "crampe (f)",
              ipa: "/kʀɑ̃p/",
            },
            {
              left: "28%",
              top: "10%",
              en: "sprain",
              fr: "entorse (f)",
              ipa: "/ɑ̃tɔʀs/",
            },
            {
              left: "48%",
              top: "10%",
              en: "backache",
              fr: "mal au dos",
              ipa: "/mal.o.do/",
            },
            {
              left: "82%",
              top: "10%",
              en: "broken bone",
              fr: "os cassé",
              ipa: "/ɔs.kɑse/",
            },
            {
              left: "10%",
              top: "56%",
              en: "high cholesterol",
              fr: "cholestérol élevé (m)",
              ipa: "/kɔlεsterɔl.el(ə)ve/",
            },
            {
              left: "24%",
              top: "56%",
              en: "high blood pressure",
              fr: "hypertension artérielle (f)",
              ipa: "/ipɛʀtɑ̃sjɔ̃.aʀteʀjɛl/",
            },
            {
              left: "50%",
              top: "56%",
              en: "diabetes",
              fr: "diabète (m)",
              ipa: "/djabɛt/",
            },
            {
              left: "65%",
              top: "56%",
              en: "heart attack",
              fr: "crise cardiaque (f)",
              ipa: "/kʀiz.kaʀdjak/",
            },
            {
              left: "84%",
              top: "56%",
              en: "stroke",
              fr: "accident vasculaire cérébral (AVC) (m)",
              ipa: "/aksidɑ̃.vaskylɛʀ.seʀebʀal/",
            },
          ],
        },
        {
          img: "../../../assets/img/body/hospital.jpg",
          alt: "Gutters and downspouts",
          hotspots: [
            {
              left: "6%",
              top: "10%",
              en: "hospital",
              fr: "hôpital (m)",
              ipa: "/ɔpital/",
            },
            {
              left: "28%",
              top: "10%",
              en: "ambulance",
              fr: "ambulance (f)",
              ipa: "/ɑ̃bylɑ̃s/",
            },
            {
              left: "45%",
              top: "10%",
              en: "stretcher",
              fr: "brancard (m)",
              ipa: "/bʀɑ̃kaʀ/",
            },
            {
              left: "70%",
              top: "10%",
              en: "first-aid kit",
              fr: "trousse de secours (f)",
              ipa: "/tʀus.də.s(ə)kuʀ/",
            },
            {
              left: "84%",
              top: "10%",
              en: "bandage",
              fr: "bandage (m)",
              ipa: "/bɑ̃daʒ/",
            },
            {
              left: "6%",
              top: "56%",
              en: "dressing",
              fr: "pansement (m)",
              ipa: "/pɑ̃smɑ̃/",
            },
            {
              left: "27%",
              top: "56%",
              en: "syringe",
              fr: "seringue (f)",
              ipa: "/s(ə)ʀɛ̃ɡ/",
            },
            {
              left: "45%",
              top: "56%",
              en: "medication",
              fr: "medication (f)",
              ipa: "/medikasjɔ̃/",
            },
            {
              left: "66%",
              top: "56%",
              en: "tablets",
              fr: "pilule (f)",
              ipa: "/pilyl/",
            },
            {
              left: "84%",
              top: "56%",
              en: "antibiotics",
              fr: "antibiotique (m)",
              ipa: "/ɑ̃tibjɔtik/",
            },
          ],
        },
      ];

      let deck = baseDeck.map((card, index) => ({ ...card, id: index }));
      let currentIndex = 0;
      const frontText = document.getElementById("card-front-text");
      const countLabel = document.getElementById("card-count");
      const thumbnailStrip = document.getElementById("thumbnailStrip");
      const hotspotTooltip = document.createElement("div");
      hotspotTooltip.className = "hotspot-tooltip";
      hotspotTooltip.setAttribute("role", "dialog");
      hotspotTooltip.setAttribute("aria-hidden", "true");
      hotspotTooltip.innerHTML = `
            <div class="hotspot-tooltip-en"></div>
            <div class="hotspot-tooltip-divider"></div>
            <div class="hotspot-tooltip-fr"></div>
            <div class="hotspot-tooltip-ipa"></div>
            <button type="button" class="hotspot-tooltip-close" aria-label="Close hotspot info">&#215;</button>
          `;
      document.body.appendChild(hotspotTooltip);
      const tooltipEn = hotspotTooltip.querySelector(".hotspot-tooltip-en");
      const tooltipFr = hotspotTooltip.querySelector(".hotspot-tooltip-fr");
      const tooltipIpa = hotspotTooltip.querySelector(".hotspot-tooltip-ipa");
      let pinnedHotspot = null;
      let hideTimer = null;

      function positionTooltip(hotspot) {
        const rect = hotspot.getBoundingClientRect();
        const tooltipRect = hotspotTooltip.getBoundingClientRect();
        let left =
          rect.left + rect.width / 2 - tooltipRect.width / 2 + window.scrollX;
        left = Math.max(
          window.scrollX + 8,
          Math.min(
            left,
            window.scrollX + window.innerWidth - tooltipRect.width - 8
          )
        );

        let top = rect.top + window.scrollY - tooltipRect.height - 12;
        if (top < window.scrollY + 8) {
          top = rect.bottom + window.scrollY + 12;
        }
        hotspotTooltip.style.left = `${left}px`;
        hotspotTooltip.style.top = `${top}px`;
      }

      function showHotspotTooltip(hotspot) {
        if (!hotspot) return;
        clearTimeout(hideTimer);
        tooltipEn.textContent = hotspot.dataset.en;
        tooltipFr.textContent = hotspot.dataset.fr;
        tooltipIpa.textContent = hotspot.dataset.ipa;
        hotspotTooltip.classList.add("is-visible");
        hotspotTooltip.setAttribute("aria-hidden", "false");
        // Temporarily make sure we can measure size even if hidden
        positionTooltip(hotspot);
      }

      function hideHotspotTooltip() {
        hotspotTooltip.classList.remove("is-visible");
        hotspotTooltip.setAttribute("aria-hidden", "true");
        pinnedHotspot = null;
      }

      function buildCardMarkup(card) {
        const hotspotMarkup = card.hotspots
          .map(
            (spot) => `
                  <button
                    class="hotspot"
                    style="left:${spot.left}; top:${spot.top};"
                    data-en="${spot.en}"
                    data-fr="${spot.fr}"
                    data-ipa="${spot.ipa}"
                  >
                    <span class="sr-only">${spot.en} / ${spot.fr}</span>
                  </button>
                `
          )
          .join("");

        return `
              <div class="hotspot-wrap">
                <img src="${card.img}" alt="${card.alt || ""}" loading="lazy">
                ${hotspotMarkup}
              </div>
            `;
      }

      // 2. Load the content
      function loadCard() {
        frontText.innerHTML = buildCardMarkup(deck[currentIndex]);
        countLabel.innerHTML = `${currentIndex + 1} / ${deck.length}`;
        hideHotspotTooltip();
        updateActiveThumbnail();
      }
      function renderThumbnails() {
        thumbnailStrip.innerHTML = "";
        baseDeck.forEach((card, idx) => {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "thumb-card";
          btn.dataset.cardId = idx;
          btn.innerHTML = `
                <div class="thumb-number">#${idx + 1}</div>
                <div class="thumb-preview"><img src="${card.img}" alt="${card.alt || ""}" loading="lazy"></div>
              `;
          btn.addEventListener("click", () => {
            const targetIndex = deck.findIndex((item) => item.id === idx);
            if (targetIndex !== -1) {
              currentIndex = targetIndex;
              loadCard();
              window.scrollTo({ top: 0, behavior: "smooth" });
            }
          });
          thumbnailStrip.appendChild(btn);
        });
        updateActiveThumbnail();
      }

      function updateActiveThumbnail() {
        const activeId = deck[currentIndex].id;
        const buttons = thumbnailStrip.querySelectorAll(".thumb-card");
        buttons.forEach((btn) => {
          const btnId = Number(btn.dataset.cardId);
          btn.classList.toggle("is-active", btnId === activeId);
        });
      }

      // 3. Navigation
      function nextCard() {
        if (currentIndex < deck.length - 1) {
          currentIndex++;
          loadCard();
        }
      }

      function prevCard() {
        if (currentIndex > 0) {
          currentIndex--;
          loadCard();
        }
      }

      // Initialize
      renderThumbnails();
      loadCard();

      // 4. Hotspot interaction
      document.addEventListener("mouseover", (event) => {
        const hotspot = event.target.closest(".hotspot");
        if (!hotspot || pinnedHotspot) return;
        showHotspotTooltip(hotspot);
      });

      document.addEventListener("mouseout", (event) => {
        const hotspot = event.target.closest(".hotspot");
        if (!hotspot || pinnedHotspot) return;
        const toElement = event.relatedTarget;
        if (
          toElement &&
          (toElement.closest(".hotspot") ||
            toElement.closest(".hotspot-tooltip"))
        ) {
          return;
        }
        hideTimer = setTimeout(hideHotspotTooltip, 120);
      });

      document.addEventListener("click", (event) => {
        if (event.target.closest(".hotspot-tooltip-close")) {
          hideHotspotTooltip();
          return;
        }

        const hotspot = event.target.closest(".hotspot");
        if (hotspot) {
          pinnedHotspot = hotspot;
          showHotspotTooltip(hotspot);
          return;
        }

        if (!event.target.closest(".hotspot-tooltip")) {
          hideHotspotTooltip();
        }
      });

      document.addEventListener("keydown", (event) => {
        if (event.key === "Escape") {
          hideHotspotTooltip();
        }
      });

      window.addEventListener("scroll", () => {
        if (pinnedHotspot) {
          positionTooltip(pinnedHotspot);
        }
      });

      window.addEventListener("resize", () => {
        if (pinnedHotspot) {
          positionTooltip(pinnedHotspot);
        }
      });
      function shuffleDeck() {
        // 1. The Fisher-Yates Shuffle Algorithm
        // (This loops backward through the deck and swaps each card with a random one)
        for (let i = deck.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [deck[i], deck[j]] = [deck[j], deck[i]];
        }

        // 2. Reset the user to the start of the newly shuffled deck
        currentIndex = 0;

        // 3. Reload the display
        loadCard();

        // Optional: Give visual feedback (e.g., update the button text briefly)
        const btn = document.querySelector('button[onclick="shuffleDeck()"]');
        const originalText = btn.innerHTML;
        btn.innerHTML = "Deck Shuffled!";
        setTimeout(() => {
          btn.innerHTML = originalText;
        }, 1000);
      }

      function reorderDeck() {
        // Restore the deck to its original sequential order
        deck = baseDeck.map((card, index) => ({ ...card, id: index }));
        currentIndex = 0;
        loadCard();

        const btn = document.querySelector('button[onclick="reorderDeck()"]');
        const originalText = btn.innerHTML;
        btn.innerHTML = "Deck Reordered!";
        setTimeout(() => {
          btn.innerHTML = originalText;
        }, 1000);
      }
    </script>
  </body>
</html>
